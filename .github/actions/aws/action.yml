name: "Resolve env APP_ID/APP_SECRET from one AWS secret"
description: "Fetch a single JSON secret and expose APP_ID/APP_SECRET for the selected env"
inputs:
  env:
    description: "Environment name (e.g. dev|stage|prod|DEV|STAGE|PROD)"
    required: true
  role_arn:
    description: "AWS role to assume (OIDC)"
    required: true
  aws_region:
    description: "AWS region for Secrets Manager"
    required: true
  secret_id:
    description: "Secret name/ARN that contains keys like DEV_APP_ID, DEV_APP_SECRET"
    required: true
runs:
  using: "composite"
  steps:
      - name: Configure AWS credentials
        uses: aws-actions/configure-aws-credentials@v4
        with:
            role-to-assume: ${{ inputs.role_arn }}
            aws-region: "us-west-2"
            role-session-name: GitHubActions-${{ github.run_id }}

      - name: Get secrets from AWS Secrets Manager
        uses: aws-actions/aws-secretsmanager-get-secrets@v1
        with:
            secret-ids: |
               , ${{ inputs.secret_id }}
            parse-json-secrets: true
